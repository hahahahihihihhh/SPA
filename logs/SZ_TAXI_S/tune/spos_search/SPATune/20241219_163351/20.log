2024-12-19 17:38:15,932 - [INFO] - Namespace(arch=['rgat_vanilla', 'gru', 'lc_skip', 'rgat_vanilla', 'identity', 'lc_skip', 'rgcn', 'identity', 'lf_max'], arch_learning_rate=0.01, arch_sample_num=1000, arch_weight_decay=0.001, base_num=1, baseline_sample_num=30, batch_size=1, comp_op='corr', dataset='SZ_TAXI_S/', dataset_dir='datasets/', dropout=0.1, embed_size=128, encoder='SPATune', fixed_ops='', genotype='rgcn||sa||lc_skip||rgcn||gru||lc_skip||compgcn_rotate||gru||lf_concat', gnn_layer_num=3, grad_clip=1, head_num=4, hidden_size=128, index=20, inv_temperature=0.1, isolated_change=False, learning_rate=0.005, log_dir='logs/', max_epoch=200, min_arch_learning_rate=0.0005, min_learning_rate=0.001, momentum=0.9, negative_sampling_num=500, optimizer='adam', positive_fact_num=3000, random_seed=43, rec_only_last_layer=True, rnn_layer_num=1, sampled_dataset=False, save_model=False, saved_model_dir='saved_models/', score_function='complex', search_max_epoch=800, search_mode='spos_search', search_res_dir='searched_res/', search_res_file='searched_res/SZ_TAXI_S/spos_search/20241219_163351.json', search_run_num=1, seq_head_num=8, stand_alone_path='', tensorboard_dir='tensorboard/', test_seq_len=8, time_log_dir='', train_mode='tune', train_seq_len=8, tune_res_dir='tune_res/', tune_sample_num=20, unrolled=False, use_time_embedding=False, weight_decay=3.123159330638725e-05, weight_path='weights/SZ_TAXI_S/search/spos/SPASPOSSearch/20241219_160051_43/epoch_800.pt')
2024-12-19 17:38:15,948 - [INFO] - Parameter size = 0.420884MB
2024-12-19 17:38:16,157 - [INFO] - [Epoch:1 | Tune]: Train Loss:12.45
2024-12-19 17:38:16,222 - [INFO] - [Epoch:1 | Valid]: Loss:12.43, MRR:0.0415, Hits@10:0.107, Hits@3:0.0286, Hits@1:0.00714
2024-12-19 17:38:16,428 - [INFO] - [Epoch:2 | Tune]: Train Loss:12.16
2024-12-19 17:38:16,491 - [INFO] - [Epoch:2 | Valid]: Loss:12.42, MRR:0.0728, Hits@10:0.1, Hits@3:0.0643, Hits@1:0.0357
2024-12-19 17:38:16,698 - [INFO] - [Epoch:3 | Tune]: Train Loss:11.56
2024-12-19 17:38:16,761 - [INFO] - [Epoch:3 | Valid]: Loss:12.38, MRR:0.0869, Hits@10:0.164, Hits@3:0.0786, Hits@1:0.0357
2024-12-19 17:38:16,966 - [INFO] - [Epoch:4 | Tune]: Train Loss:10.37
2024-12-19 17:38:17,029 - [INFO] - [Epoch:4 | Valid]: Loss:12.26, MRR:0.103, Hits@10:0.179, Hits@3:0.0857, Hits@1:0.05
2024-12-19 17:38:17,236 - [INFO] - [Epoch:5 | Tune]: Train Loss:8.817
2024-12-19 17:38:17,301 - [INFO] - [Epoch:5 | Valid]: Loss:12.08, MRR:0.117, Hits@10:0.229, Hits@3:0.121, Hits@1:0.0429
2024-12-19 17:38:17,505 - [INFO] - [Epoch:6 | Tune]: Train Loss:7.508
2024-12-19 17:38:17,569 - [INFO] - [Epoch:6 | Valid]: Loss:11.91, MRR:0.146, Hits@10:0.321, Hits@3:0.129, Hits@1:0.0643
2024-12-19 17:38:17,614 - [INFO] - [Epoch:6 | Test]: Loss:0.0, MRR:0.146, Hits@10:0.321, Hits@3:0.129, Hits@1:0.0643
2024-12-19 17:38:17,614 - [INFO] - Success
2024-12-19 17:38:17,836 - [INFO] - [Epoch:7 | Tune]: Train Loss:6.164
2024-12-19 17:38:17,900 - [INFO] - [Epoch:7 | Valid]: Loss:11.75, MRR:0.149, Hits@10:0.364, Hits@3:0.136, Hits@1:0.0571
2024-12-19 17:38:17,947 - [INFO] - [Epoch:7 | Test]: Loss:0.0, MRR:0.149, Hits@10:0.364, Hits@3:0.136, Hits@1:0.0571
2024-12-19 17:38:17,947 - [INFO] - Success
2024-12-19 17:38:18,157 - [INFO] - [Epoch:8 | Tune]: Train Loss:4.893
2024-12-19 17:38:18,221 - [INFO] - [Epoch:8 | Valid]: Loss:11.58, MRR:0.173, Hits@10:0.386, Hits@3:0.193, Hits@1:0.0714
2024-12-19 17:38:18,267 - [INFO] - [Epoch:8 | Test]: Loss:0.0, MRR:0.173, Hits@10:0.386, Hits@3:0.193, Hits@1:0.0714
2024-12-19 17:38:18,267 - [INFO] - Success
2024-12-19 17:38:18,475 - [INFO] - [Epoch:9 | Tune]: Train Loss:3.724
2024-12-19 17:38:18,538 - [INFO] - [Epoch:9 | Valid]: Loss:11.39, MRR:0.169, Hits@10:0.436, Hits@3:0.15, Hits@1:0.0714
2024-12-19 17:38:18,743 - [INFO] - [Epoch:10 | Tune]: Train Loss:2.815
2024-12-19 17:38:18,806 - [INFO] - [Epoch:10 | Valid]: Loss:11.15, MRR:0.176, Hits@10:0.45, Hits@3:0.179, Hits@1:0.0643
2024-12-19 17:38:18,851 - [INFO] - [Epoch:10 | Test]: Loss:0.0, MRR:0.176, Hits@10:0.45, Hits@3:0.179, Hits@1:0.0643
2024-12-19 17:38:18,852 - [INFO] - Success
2024-12-19 17:38:19,058 - [INFO] - [Epoch:11 | Tune]: Train Loss:2.066
2024-12-19 17:38:19,120 - [INFO] - [Epoch:11 | Valid]: Loss:10.92, MRR:0.195, Hits@10:0.479, Hits@3:0.207, Hits@1:0.0786
2024-12-19 17:38:19,169 - [INFO] - [Epoch:11 | Test]: Loss:0.0, MRR:0.195, Hits@10:0.479, Hits@3:0.207, Hits@1:0.0786
2024-12-19 17:38:19,169 - [INFO] - Success
2024-12-19 17:38:19,376 - [INFO] - [Epoch:12 | Tune]: Train Loss:1.586
2024-12-19 17:38:19,439 - [INFO] - [Epoch:12 | Valid]: Loss:10.76, MRR:0.231, Hits@10:0.479, Hits@3:0.243, Hits@1:0.114
2024-12-19 17:38:19,484 - [INFO] - [Epoch:12 | Test]: Loss:0.0, MRR:0.231, Hits@10:0.479, Hits@3:0.243, Hits@1:0.114
2024-12-19 17:38:19,484 - [INFO] - Success
2024-12-19 17:38:19,691 - [INFO] - [Epoch:13 | Tune]: Train Loss:0.9381
2024-12-19 17:38:19,754 - [INFO] - [Epoch:13 | Valid]: Loss:10.79, MRR:0.249, Hits@10:0.493, Hits@3:0.264, Hits@1:0.129
2024-12-19 17:38:19,800 - [INFO] - [Epoch:13 | Test]: Loss:0.0, MRR:0.249, Hits@10:0.493, Hits@3:0.264, Hits@1:0.129
2024-12-19 17:38:19,800 - [INFO] - Success
2024-12-19 17:38:20,007 - [INFO] - [Epoch:14 | Tune]: Train Loss:0.7989
2024-12-19 17:38:20,070 - [INFO] - [Epoch:14 | Valid]: Loss:10.98, MRR:0.273, Hits@10:0.571, Hits@3:0.3, Hits@1:0.15
2024-12-19 17:38:20,115 - [INFO] - [Epoch:14 | Test]: Loss:0.0, MRR:0.273, Hits@10:0.571, Hits@3:0.3, Hits@1:0.15
2024-12-19 17:38:20,115 - [INFO] - Success
2024-12-19 17:38:20,329 - [INFO] - [Epoch:15 | Tune]: Train Loss:0.495
2024-12-19 17:38:20,393 - [INFO] - [Epoch:15 | Valid]: Loss:11.64, MRR:0.29, Hits@10:0.579, Hits@3:0.321, Hits@1:0.164
2024-12-19 17:38:20,438 - [INFO] - [Epoch:15 | Test]: Loss:0.0, MRR:0.29, Hits@10:0.579, Hits@3:0.321, Hits@1:0.164
2024-12-19 17:38:20,438 - [INFO] - Success
2024-12-19 17:38:20,643 - [INFO] - [Epoch:16 | Tune]: Train Loss:0.4282
2024-12-19 17:38:20,708 - [INFO] - [Epoch:16 | Valid]: Loss:12.3, MRR:0.319, Hits@10:0.629, Hits@3:0.35, Hits@1:0.193
2024-12-19 17:38:20,754 - [INFO] - [Epoch:16 | Test]: Loss:0.0, MRR:0.319, Hits@10:0.629, Hits@3:0.35, Hits@1:0.193
2024-12-19 17:38:20,754 - [INFO] - Success
2024-12-19 17:38:20,962 - [INFO] - [Epoch:17 | Tune]: Train Loss:0.2191
2024-12-19 17:38:21,026 - [INFO] - [Epoch:17 | Valid]: Loss:13.49, MRR:0.327, Hits@10:0.607, Hits@3:0.357, Hits@1:0.207
2024-12-19 17:38:21,071 - [INFO] - [Epoch:17 | Test]: Loss:0.0, MRR:0.327, Hits@10:0.607, Hits@3:0.357, Hits@1:0.207
2024-12-19 17:38:21,072 - [INFO] - Success
2024-12-19 17:38:21,279 - [INFO] - [Epoch:18 | Tune]: Train Loss:0.189
2024-12-19 17:38:21,344 - [INFO] - [Epoch:18 | Valid]: Loss:14.99, MRR:0.308, Hits@10:0.65, Hits@3:0.364, Hits@1:0.164
2024-12-19 17:38:21,551 - [INFO] - [Epoch:19 | Tune]: Train Loss:0.1602
2024-12-19 17:38:21,614 - [INFO] - [Epoch:19 | Valid]: Loss:16.27, MRR:0.336, Hits@10:0.636, Hits@3:0.379, Hits@1:0.2
2024-12-19 17:38:21,659 - [INFO] - [Epoch:19 | Test]: Loss:0.0, MRR:0.336, Hits@10:0.636, Hits@3:0.379, Hits@1:0.2
2024-12-19 17:38:21,659 - [INFO] - Success
2024-12-19 17:38:21,867 - [INFO] - [Epoch:20 | Tune]: Train Loss:0.1683
2024-12-19 17:38:21,930 - [INFO] - [Epoch:20 | Valid]: Loss:17.83, MRR:0.354, Hits@10:0.643, Hits@3:0.407, Hits@1:0.214
2024-12-19 17:38:21,975 - [INFO] - [Epoch:20 | Test]: Loss:0.0, MRR:0.354, Hits@10:0.643, Hits@3:0.407, Hits@1:0.214
2024-12-19 17:38:21,976 - [INFO] - Success
2024-12-19 17:38:22,185 - [INFO] - [Epoch:21 | Tune]: Train Loss:0.1689
2024-12-19 17:38:22,251 - [INFO] - [Epoch:21 | Valid]: Loss:19.47, MRR:0.404, Hits@10:0.629, Hits@3:0.471, Hits@1:0.286
2024-12-19 17:38:22,297 - [INFO] - [Epoch:21 | Test]: Loss:0.0, MRR:0.404, Hits@10:0.629, Hits@3:0.471, Hits@1:0.286
2024-12-19 17:38:22,298 - [INFO] - Success
2024-12-19 17:38:22,507 - [INFO] - [Epoch:22 | Tune]: Train Loss:0.1039
2024-12-19 17:38:22,570 - [INFO] - [Epoch:22 | Valid]: Loss:21.54, MRR:0.399, Hits@10:0.643, Hits@3:0.457, Hits@1:0.271
2024-12-19 17:38:22,779 - [INFO] - [Epoch:23 | Tune]: Train Loss:0.191
2024-12-19 17:38:22,844 - [INFO] - [Epoch:23 | Valid]: Loss:23.57, MRR:0.382, Hits@10:0.643, Hits@3:0.429, Hits@1:0.25
2024-12-19 17:38:23,049 - [INFO] - [Epoch:24 | Tune]: Train Loss:0.1047
2024-12-19 17:38:23,114 - [INFO] - [Epoch:24 | Valid]: Loss:25.62, MRR:0.386, Hits@10:0.65, Hits@3:0.457, Hits@1:0.25
2024-12-19 17:38:23,322 - [INFO] - [Epoch:25 | Tune]: Train Loss:0.1791
2024-12-19 17:38:23,385 - [INFO] - [Epoch:25 | Valid]: Loss:27.86, MRR:0.38, Hits@10:0.664, Hits@3:0.479, Hits@1:0.221
2024-12-19 17:38:23,592 - [INFO] - [Epoch:26 | Tune]: Train Loss:0.1204
2024-12-19 17:38:23,655 - [INFO] - [Epoch:26 | Valid]: Loss:30.37, MRR:0.381, Hits@10:0.671, Hits@3:0.471, Hits@1:0.229
2024-12-19 17:38:23,862 - [INFO] - [Epoch:27 | Tune]: Train Loss:0.09232
2024-12-19 17:38:23,925 - [INFO] - [Epoch:27 | Valid]: Loss:32.81, MRR:0.367, Hits@10:0.671, Hits@3:0.457, Hits@1:0.207
2024-12-19 17:38:24,132 - [INFO] - [Epoch:28 | Tune]: Train Loss:0.1405
2024-12-19 17:38:24,197 - [INFO] - [Epoch:28 | Valid]: Loss:35.09, MRR:0.331, Hits@10:0.679, Hits@3:0.371, Hits@1:0.193
2024-12-19 17:38:24,404 - [INFO] - [Epoch:29 | Tune]: Train Loss:0.1255
2024-12-19 17:38:24,468 - [INFO] - [Epoch:29 | Valid]: Loss:36.68, MRR:0.295, Hits@10:0.686, Hits@3:0.35, Hits@1:0.143
2024-12-19 17:38:24,674 - [INFO] - [Epoch:30 | Tune]: Train Loss:0.1201
2024-12-19 17:38:24,737 - [INFO] - [Epoch:30 | Valid]: Loss:39.1, MRR:0.275, Hits@10:0.671, Hits@3:0.3, Hits@1:0.129
2024-12-19 17:38:24,945 - [INFO] - [Epoch:31 | Tune]: Train Loss:0.1452
2024-12-19 17:38:25,007 - [INFO] - [Epoch:31 | Valid]: Loss:40.42, MRR:0.223, Hits@10:0.629, Hits@3:0.221, Hits@1:0.0786
2024-12-19 17:38:25,215 - [INFO] - [Epoch:32 | Tune]: Train Loss:0.142
2024-12-19 17:38:25,280 - [INFO] - [Epoch:32 | Valid]: Loss:43.08, MRR:0.22, Hits@10:0.621, Hits@3:0.257, Hits@1:0.0571
2024-12-19 17:38:25,487 - [INFO] - [Epoch:33 | Tune]: Train Loss:0.1061
2024-12-19 17:38:25,550 - [INFO] - [Epoch:33 | Valid]: Loss:45.16, MRR:0.203, Hits@10:0.636, Hits@3:0.2, Hits@1:0.0571
2024-12-19 17:38:25,757 - [INFO] - [Epoch:34 | Tune]: Train Loss:0.08281
2024-12-19 17:38:25,821 - [INFO] - [Epoch:34 | Valid]: Loss:46.47, MRR:0.228, Hits@10:0.629, Hits@3:0.229, Hits@1:0.0857
2024-12-19 17:38:26,027 - [INFO] - [Epoch:35 | Tune]: Train Loss:0.1081
2024-12-19 17:38:26,091 - [INFO] - [Epoch:35 | Valid]: Loss:47.62, MRR:0.244, Hits@10:0.621, Hits@3:0.229, Hits@1:0.121
2024-12-19 17:38:26,296 - [INFO] - [Epoch:36 | Tune]: Train Loss:0.06397
2024-12-19 17:38:26,360 - [INFO] - [Epoch:36 | Valid]: Loss:48.67, MRR:0.227, Hits@10:0.607, Hits@3:0.236, Hits@1:0.0929
2024-12-19 17:38:26,565 - [INFO] - [Epoch:37 | Tune]: Train Loss:0.04266
2024-12-19 17:38:26,629 - [INFO] - [Epoch:37 | Valid]: Loss:51.17, MRR:0.216, Hits@10:0.607, Hits@3:0.229, Hits@1:0.0714
2024-12-19 17:38:26,835 - [INFO] - [Epoch:38 | Tune]: Train Loss:0.05199
2024-12-19 17:38:26,899 - [INFO] - [Epoch:38 | Valid]: Loss:51.46, MRR:0.181, Hits@10:0.6, Hits@3:0.193, Hits@1:0.0429
2024-12-19 17:38:27,106 - [INFO] - [Epoch:39 | Tune]: Train Loss:0.03
2024-12-19 17:38:27,173 - [INFO] - [Epoch:39 | Valid]: Loss:52.87, MRR:0.17, Hits@10:0.564, Hits@3:0.164, Hits@1:0.0429
2024-12-19 17:38:27,381 - [INFO] - [Epoch:40 | Tune]: Train Loss:0.03712
2024-12-19 17:38:27,444 - [INFO] - [Epoch:40 | Valid]: Loss:53.67, MRR:0.17, Hits@10:0.55, Hits@3:0.171, Hits@1:0.0357
2024-12-19 17:38:27,651 - [INFO] - [Epoch:41 | Tune]: Train Loss:0.02608
2024-12-19 17:38:27,714 - [INFO] - [Epoch:41 | Valid]: Loss:54.98, MRR:0.171, Hits@10:0.55, Hits@3:0.186, Hits@1:0.0357
2024-12-19 17:38:27,922 - [INFO] - [Epoch:42 | Tune]: Train Loss:0.0366
2024-12-19 17:38:27,984 - [INFO] - [Epoch:42 | Valid]: Loss:54.85, MRR:0.179, Hits@10:0.529, Hits@3:0.164, Hits@1:0.0571
2024-12-19 17:38:28,193 - [INFO] - [Epoch:43 | Tune]: Train Loss:0.01694
2024-12-19 17:38:28,256 - [INFO] - [Epoch:43 | Valid]: Loss:56.62, MRR:0.184, Hits@10:0.507, Hits@3:0.171, Hits@1:0.0643
2024-12-19 17:38:28,463 - [INFO] - [Epoch:44 | Tune]: Train Loss:0.01808
2024-12-19 17:38:28,527 - [INFO] - [Epoch:44 | Valid]: Loss:57.54, MRR:0.185, Hits@10:0.493, Hits@3:0.179, Hits@1:0.0643
2024-12-19 17:38:28,733 - [INFO] - [Epoch:45 | Tune]: Train Loss:0.009585
2024-12-19 17:38:28,797 - [INFO] - [Epoch:45 | Valid]: Loss:57.75, MRR:0.173, Hits@10:0.464, Hits@3:0.164, Hits@1:0.0571
2024-12-19 17:38:29,004 - [INFO] - [Epoch:46 | Tune]: Train Loss:0.01725
2024-12-19 17:38:29,067 - [INFO] - [Epoch:46 | Valid]: Loss:58.16, MRR:0.181, Hits@10:0.443, Hits@3:0.171, Hits@1:0.0714
2024-12-19 17:38:29,276 - [INFO] - [Epoch:47 | Tune]: Train Loss:0.03433
2024-12-19 17:38:29,340 - [INFO] - [Epoch:47 | Valid]: Loss:58.0, MRR:0.171, Hits@10:0.45, Hits@3:0.164, Hits@1:0.0571
2024-12-19 17:38:29,341 - [INFO] - Early stop!
2024-12-19 17:38:29,341 - [INFO] - 0.40446504950523376 rgcn||sa||lc_skip||rgcn||gru||lc_skip||compgcn_rotate||gru||lf_concat
